<!DOCTYPE html>
<html>

<head>
    <title>Blockly for house</title>
</head>

<body>
    <!--Import blockly library and standard blocks-->
    <script src="../../blockly/blockly_compressed.js"></script>
    <script src="../../blockly/blocks_compressed.js"></script>
    <script src="../../blockly/msg/js/en.js"></script>
    <script src="../../blockly/python_compressed.js"></script>
    <!--Import our blocks-->
    <script src="blocks/Actuators/door.js"></script>
    <script src="blocks/Actuators/lamp.js"></script>
    <script src="blocks/Sensors/illuminance.js"></script>
    <script src="blocks/Sensors/humidity.js"></script>
    <script src="blocks/Sensors/temperature.js"></script>
    <!--Import generation from our blocks-->
    <script src="generators/python/Actuators/door.js"></script>
    <script src="generators/python/Actuators/lamp.js"></script>
    <script src="generators/python/Sensors/illuminance.js"></script>
    <script src="generators/python/Sensors/humidity.js"></script>
    <script src="generators/python/Sensors/temperature.js"></script>


    <h1>Hi!</h1>
    <h3>In this version:</h3>
    <p>Категоризация и больше блоков</p>
    <p><a href="../../index.html">Back</a></p>
    <table>
        <tr>
            <td>
                    <div id="blocklyDiv" style="height: 480px; width: 600px;"></div>
                    <xml id="toolbox" style="display: none">
                        <category name="Logic" colour="%{BKY_LOGIC_HUE}">
                            <category name="If">
                                <block type="controls_if"></block>
                                <block type="controls_if">
                                    <mutation else="1"></mutation>
                                </block>
                                <block type="controls_if">
                                    <mutation elseif="1" else="1"></mutation>
                                </block>
                            </category>
                            <category name="Boolean" colour="%{BKY_LOGIC_HUE}">
                                <block type="logic_compare"></block>
                                <block type="logic_operation"></block>
                                <block type="logic_negate"></block>
                                <block type="logic_boolean"></block>
                                <block type="logic_null"></block>
                                <block type="logic_ternary"></block>
                            </category>
                        </category>
                        <category name="Loops" colour="%{BKY_LOOPS_HUE}">
                            <block type="controls_repeat_ext">
                                <value name="TIMES">
                                    <block type="math_number">
                                        <field name="NUM">10</field>
                                    </block>
                                </value>
                            </block>
                            <block type="controls_whileUntil"></block>
                            <block type="controls_for">
                                <field name="VAR">i</field>
                                <value name="FROM">
                                    <block type="math_number">
                                        <field name="NUM">1</field>
                                    </block>
                                </value>
                                <value name="TO">
                                    <block type="math_number">
                                        <field name="NUM">10</field>
                                    </block>
                                </value>
                                <value name="BY">
                                    <block type="math_number">
                                        <field name="NUM">1</field>
                                    </block>
                                </value>
                            </block>
                            <block type="controls_forEach"></block>
                            <block type="controls_flow_statements"></block>
                        </category>
                        <category name="Math" colour="%{BKY_MATH_HUE}">
                            <block type="math_number">
                                <field name="NUM">123</field>
                            </block>
                            <block type="math_arithmetic"></block>
                            <block type="math_single"></block>
                            <block type="math_trig"></block>
                            <block type="math_constant"></block>
                            <block type="math_number_property"></block>
                            <block type="math_round"></block>
                            <block type="math_on_list"></block>
                            <block type="math_modulo"></block>
                            <block type="math_constrain">
                                <value name="LOW">
                                    <block type="math_number">
                                        <field name="NUM">1</field>
                                    </block>
                                </value>
                                <value name="HIGH">
                                    <block type="math_number">
                                        <field name="NUM">100</field>
                                    </block>
                                </value>
                            </block>
                            <block type="math_random_int">
                                <value name="FROM">
                                    <block type="math_number">
                                        <field name="NUM">1</field>
                                    </block>
                                </value>
                                <value name="TO">
                                    <block type="math_number">
                                        <field name="NUM">100</field>
                                    </block>
                                </value>
                            </block>
                            <block type="math_random_float"></block>
                            <block type="math_atan2"></block>
                        </category>
                        <category name="Lists" colour="%{BKY_LISTS_HUE}">
                            <block type="lists_create_empty"></block>
                            <block type="lists_create_with"></block>
                            <block type="lists_repeat">
                                <value name="NUM">
                                    <block type="math_number">
                                        <field name="NUM">5</field>
                                    </block>
                                </value>
                            </block>
                            <block type="lists_length"></block>
                            <block type="lists_isEmpty"></block>
                            <block type="lists_indexOf"></block>
                            <block type="lists_getIndex"></block>
                            <block type="lists_setIndex"></block>
                        </category>
                        <sep></sep>
                        <category name="Text" colour="%{BKY_TEXTS_HUE}">
                            <block type="text"></block>
                            <block type="text_length"></block>
                            <block type="text_print"></block>
                        </category>
                        <sep></sep>
                        <category name="Actuators" colour=110>
                            <category name="Door" colour=130>
                                <block type="door"></block>
                                <block type="open_door"></block>
                                <block type="close_door"></block>
                                <block type="door_is_open"></block>
                            </category>
                            <sep></sep>
                            <category name = "Lamp">
                                <block type="lamp"></block>
                                <block type="off_lamp"></block>
                                <block type="on_lamp"></block>
                                <block type="lamp_is_on"></block>
                            </category>
                            <sep></sep> 
                        </category>
                        <sep></sep>
                        <category name="Sensors" colour=170>
                            <category name="Temperature">
                                <block type="tem_sensor"></block>
                                <block type="tem_get"></block>
                                <block type="temperature"></block>
                            </category>
                            <category name="Humidity">
                                <block type="hum_sensor"></block>
                                <block type="hum_get"></block>
                                <block type="humidity"></block>
                            </category>
                            <category name="Illuminance">
                                <block type="il_sensor"></block>
                                <block type="il_get"></block>
                                <block type="illuminance"></block>
                            </category>
                        </category>
                        <sep></sep>
                        <category name="Variables" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>
                    </xml>
                    <script>
                        var workspace = Blockly.inject('blocklyDiv',
                            { toolbox: document.getElementById('toolbox') });
                            
                    </script>
            </td>
            <td>
                    <h5>Code output / Xml input</h5>
                    <textarea id='code_output' style="height: 480px; width: 600px;">#here will be code!</textarea>
                
                
                    <script>
                     function generate(event) {
                            var code = Blockly.Python.workspaceToCode(workspace);
                            document.getElementById('code_output').value = code;
                        }
                        workspace.addChangeListener(generate);
                    </script>
                    <script>
                    function get_xml(){
                        console.log('inside get_xml');
                        var xml = Blockly.Xml.workspaceToDom(workspace);
                        document.getElementById('code_output').value = Blockly.Xml.domToPrettyText(xml);;
                    }
                    function from_xml(){
                       console.log('inside from_xml');
                       var xml = document.getElementById("code_output").value;
                       Blockly.Xml.appendDomToWorkspace(Blockly.Xml.textToDom(xml), workspace);  
                    }
                    </script>
                    <button id="to_xml_button" onclick="get_xml()">To XML</button>
                    <button id='from_xml_button' onclick="from_xml()">From XML</button>
            </td>
        </tr>
    </table>
   
    
</body>

</html>